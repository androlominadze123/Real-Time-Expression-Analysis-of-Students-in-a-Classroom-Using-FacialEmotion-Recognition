import csv
def GetData(filename):
    reshape_size = (48,48)

    X = []
    Y = []
    with open(filename) as csv_file:
        f = 0
        csv_reader = csv.reader(csv_file, delimiter=',')
        for row in csv_reader:
            if f == 0 :
                print(row)
                f = 1
            elif f == 1:
                pixels = np.fromstring(row[1], dtype=int, sep=' ')
                pixels = pixels.reshape( reshape_size )
                emotion = int(row[0])

                X.append(pixels)
                Y.append(emotion)
    return [X,Y]
  [train_x, train_y] = GetData('train.csv')
    [val_x, val_y] = GetData('val.csv')
    [test_x, test_y] = GetData('test.csv')
    val_x = np.array(val_x)
    val_y = np.array(val_y)
    train_x = np.array(train_x)
    train_y = np.array(train_y)
    test_x = np.array(test_x)
    test_y = np.array(test_y)
    #train_x ,test_x, train_y,test_y = train_test_split(x, y, test_size=0.1, random_state=42)
    #train_x,val_x, train_y, val_y= train_test_split(train_x, train_y, test_size=0.1, random_state=41) 
    val_x=val_x/255  
    test_x=test_x/255    
    train_x=train_x/255            
    train_x = train_x.reshape((train_x.shape[0], 48, 48,1 ))
    val_x= val_x.reshape((val_x.shape[0] ,48, 48,1))   
    test_x= test_x.reshape((test_x.shape[0],48, 48,1)) 